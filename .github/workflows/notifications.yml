name: Send Scheduled Notifications

on:
  schedule:
    # Lunes 12:00 (Bolivia)  -> UTC = Lunes 16:00
    - cron: "0 16 * * 1"
    # Martes 19:00 (Bolivia) -> UTC = Martes 23:00
    - cron: "0 23 * * 2"
    # Miércoles 15:00 (Bolivia) -> UTC = Mié 19:00
    - cron: "0 19 * * 3"
    # Jueves 11:00 (Bolivia) -> UTC = Jue 15:00
    - cron: "0 15 * * 4"
    # Viernes 12:00 (Bolivia) -> UTC = Vie 16:00
    - cron: "0 16 * * 5"
    # Viernes 19:00 (Bolivia) -> UTC = Vie 23:00
    - cron: "0 23 * * 5"
    # Sábado 17:00 (Bolivia) -> UTC = Sáb 21:00
    - cron: "0 21 * * 6"
    # Sábado 22:00 (Bolivia) -> UTC = Domingo 02:00 (por eso day-of-week = 0)
    - cron: "0 2 * * 0"
    # Domingo 12:00 (Bolivia) -> UTC = Dom 16:00
    - cron: "0 15 * * 0"
    # Domingo 19:00 (Bolivia) -> UTC = Dom 23:00
    - cron: "0 23 * * 0"
  workflow_dispatch: # permite ejecutar manualmente desde Actions
    inputs: {}

jobs:
  notify:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout repo
        uses: actions/checkout@v4

      - name: Use Node.js 20
        uses: actions/setup-node@v4
        with:
          node-version: 20

      - name: Install deps
        run: npm ci || npm install

      - name: Run sender
        run: npm run send
        env:
          FIREBASE_SERVICE_ACCOUNT: ${{ secrets.FIREBASE_SERVICE_ACCOUNT }}
          TOPIC: all
